
function Valkyr_Arise_Enum takes nothing returns boolean
  return IsUnitType (GetFilterUnit(), UNIT_TYPE_DEAD)
endfunction

function Vakyr_Arise_A takes nothing returns nothing
  local unit caster = GetTriggerUnit()
  local integer casterOwner = GetPlayerId (GetOwningPlayer (caster))
  local real x = GetSpellTargetX()
  local real y = GetSpellTargetY()
  local real target_x
  local real target_y
  local real closest
  local unit temp

  call GroupEnumUnitsInRange (udg_generic_group, x, y, 350, function Valkyr_Arise_Filter)

  loop
			set temp_x = GetUnitX(temp)
			set temp_y = GetUnitY(temp)

			set temp_distanceX = temp_x - x
			set temp_distanceY = temp_y - y

			set temp_distance = SquareRoot(temp_distanceX * temp_distanceX + temp_distanceY * temp_distanceY)

			if nearest == 0 or temp_distance < nearest then
				set nearest = temp_distance
				set nearest_unit = GetUnitUserData(temp)
  endloop
  

endfunction

function Valkyr_Arise_C takes nothing returns boolean
  return GetSpellAbilityId() == arise
endfunction


function InitTrig_Arise takes nothing returns nothing

  local trigger t = CreateTrigger()

  call TriggerRegiterAnyUnitEventBJ (t, EVENT_PLAYER_UNIT_SPELL_EFFECT)
  call TriggerAddCondition (t, Condition (function Valkyr_Arise_C)
  cakk TriggerAddAction    (t, function Valkyr_Arise_A)

  set t = null
endfunction
