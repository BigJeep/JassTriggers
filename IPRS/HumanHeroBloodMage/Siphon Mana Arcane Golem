//

//- Functions
function Arcane_Golem takes nothing returns boolean

  local unit caster = GetTriggerUnit()
  local unit target = GetSpellTargetUnit()
  local unit golem
  
  local player p = GetOwningPlayer(caster)
  
  local effect sfx
  
//local integer pNumber = 
  
  local real caster_x = GetUnitX(caster)
  local real caster_y = GetUnitY(caster)
  local real target_x = GetUnitX(caster)
  local real target_y = GetUnitY(caster)
  
  local real midway_x = (caster_x + target_x)/2
  local real midway_y = (caster_y + target_y)/2
  
  local real caster_mana = GetUnitState(caster, UNIT_STATE_MANA)
  local real caster_max = GetUnitState(caster, UNIT_MAX_MANA)
  local real target_mana = GetUnitState(target, UNIT_STATE_MANA)
  local real target_max = GetUnitState(target, UNIT_MAX_MANA)
  
  local real caster_total = caster_mana/caster_max
  local real target_total = target_mana/target_max
  
  local real buff_amount
  
  local real facing_angle = GetUnitFacing(caster)
  
  if udg_hasGolem[pNumber] == false then
    if caster_total > target_total then
      set buff_amount = caster_total - target_total
    else
      set buff_amount = target_total - caster_total
    endif
    
  //set golem = CreateUnit(p, 'golem id', x, y, facing_angle)
  //set sfx = 
    call UnitApplyTimedLife (golem, 'BTLF', 60)
    SetUnitAnimation(golem, 'birth')
    QueueUnitAnimation(golem, 'stand')
  
  //apply buffs here (golem, buff_amount)
    set udg_hasGolem[pNumber] = true
    
  elseif
  
  call DestroyEffect(sfx)
  set caster = null
  set target = null
  set golem = null
  set p = null
  set sfx = null
  
endfunction

function Remove_Golem takes nothing returns boolean
//local integer pNumber = 
 // if GetUnitTypeID(GetTriggerUnit()) == 'golem id' then
   // set udg_hasGolem[pNumber] = false
  //endif
  return false
endfunction

//- Triggers
function InitTrig_Arcane_Golem takes nothing returns nothing
  local trigger createGolem = CreateTrigger()
  local trigger killGolem = CreateTrigger()
  
  call TriggerRegisterAnyUnitEventBJ(createGolem, EVENT_PLAYER_UNIT_SPELL_ENDCAST)
  call TriggerRegisterAnyUnitEventBJ(killGolem, EVEN_PLAYER_UNIT_DIES)
  
  call TriggerAddCondition (createGolem, Condition(function Arcane_Golem)
  call TriggerAddCondition (killGolem, Condition(function Remove_Golem)
  
  set createGolem = null
  set killGolem = null
endfunction
//
